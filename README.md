# heartbeat-from-BCG
Automated heartbeat detection from BCG signals using advanced machine learning techniques

## Definitions and tools
**Ballistocardiogram (BCG):** BCG is a graphical representation of the mechanical movements of the body caused by cardiac activity.
It measures the recoil forces generated by the ejection of blood from the heart with each heartbeat.
These movements can be detected by sensors placed on the body.
BCG has the advantage of the ability to assess the cardiac condition with unconstrained
or even an unawareness of the patient.

**Electrocardiogram (ECG):** It measures and records the electrical activity of the heart.
The ECG waveform consists of different components, including P waves, QRS complex, and T waves. These components represent specific electrical events in the
heart's cardiac cycle.

**Oculus Quest VR headset:** Oculus Quest is one of the most successful virtual reality visors.
The reliability of such devices for scientific purposes has already been demonstrated in related papers to estimate the heart and respiratory rate in lab conditions.
The sampling rate of this device is 71.43 Hz.

**Move4 single lead ECG:** Move4 provides the gold standard ECG signal during the acquisition protocol.
In addition to the ECG sensor, this device embeds a triaxial accelerometer and gyroscope.

## Data acquisition protocol
The protocol includes four levels of imposed breathing with a descending frequency rate, with the subject in a sitting position. All the levels feature twelve breaths at a constant breathing period.
* Level 1: the breathing duration is 4 seconds per breath
* Level 2: the breathing duration is 6 seconds per breath
* Level 3: the breathing duration is 8 seconds per breath
* Level 4: the breathing duration is 10 seconds per breath
  
Twenty-six people were engaged to participate in the protocol. Among them, fourteen were male, and twelve were female. The average age was 26.15 years (± 2.44), height 171.26 cm (± 8.06 cm), and weight 63.67Kg (± 9.82 Kg).

## Data preparation
BCG filtering: BCG signals are filtered with a fourth-order Butterworth filter With an appropriate cut-off frequency (0.5-10 Hz).
According to the ECG, the best BCG axis is selected.

ECG filtering: A fourth-order, zero-phase Butterworth filter is used for the ECG signal with a cut-off frequency of 0.5- 30 Hz to remove artifacts from breathing or body movements.

## Dataset preparation
The Pan-Tompkins algorithm is applied to the ECG signal to extract the QRS complexes and compute R-peaks and RR intervals.

The fiducial peak point of BCG is an I-J-K complex which corresponds with ventricle contraction and Electrocardiogram (ECG) QRS complex.

All level records completed by all subjects were visually inspected and were manually aligned to identify corresponding points on both the ECG and the visor’s recordings.

## Data labeling
The labeling method in this project is a supervised method and is based on a
The “template matching” rule was evaluated using a correlation function in a local moving-window procedure.

Accurate labeling is of paramount importance for supervised machine learning. It must be emphasized that ECG here is used for constructing the training data set only, but will not be required during the processing of test data.
An ‘IJK complex’ label occurred if all fiducial points were identified or if only the fiducial points of the early systolic phase were correctly present. If the RR window was not further examined the window was labeled as a ‘non-IJK complex’.

## Model selection
Different machine learning algorithms such as Random Forest (RF), Convolutional Neural Networks (CNN), and Long Short-Term Memory (LSTM) should be applied to the dataset.

## Progress and Accomplishments

Up to this point, both BCG and ECG data have been acquired from VR and Movesen sensors. The data underwent a filtering process, and the Pan-Tompkins algorithm was applied to the ECG signals. Additionally, the fiducial points of the BCG signals were verified. For supervised learning, data labeling was performed using a 'template matching' rule and was evaluated using a correlation function within a local moving-window procedure. Furthermore, we have explored the feasibility of detecting individual heartbeats through thresholding applied to linear and rotational kinetic energy signals computed from the VR data.

We plan to apply Random Forest (RF), Convolutional Neural Networks (CNN), and Long Short-Term Memory (LSTM) models to the data.
## References
[1] Innovative sensor-free biofeedback during an imposed breathing protocol using the inertial sensors embedded in a Virtual Reality headset, Andrea Carpi

[2] Automatic heartbeat detection using machine learning and deep learning methods on Seismocardiographic signals, Angela Cortese

[3] Automated and precise heartbeat detection in ballistocardiography signals
using bidirectional LSTM Shiyu Zhang a, Haihong Zhang b, Zhiping Lin a,∗, Soon Huat Ng b

[4] Automatic Ballistocardiogram (BCG) Beat Detection Using a Template Matching Approach J. H. Shin, B. H. Choi, Y. G. Lim, D. U. Jeong and K. S. Park

[5] Towards the standardization of ballistocardiography systems for J-peak timing measurement
Joan Gomez-Clapers , Albert Serra-Rocamora, Ramon Casanella, Ramon Pallas-Areny
